<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - Summit Gear & Adventures</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .login-container { width: 100%; max-width: 420px; }
        
        .login-card {
            background: white;
            border-radius: 1.5rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }
        
        .login-header {
            background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
            color: white;
            padding: 2.5rem 2rem;
            text-align: center;
        }
        
        .login-header .icon { font-size: 3rem; margin-bottom: 0.75rem; }
        .login-header h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .login-header p { opacity: 0.9; font-size: 0.95rem; }
        
        .login-body { padding: 2rem; }
        
        .form-group { margin-bottom: 1.5rem; }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
            font-size: 0.9rem;
        }
        
        .form-group input {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.75rem;
            font-size: 1rem;
            transition: all 0.3s;
            background: #f9fafb;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #7c3aed;
            background: white;
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1);
        }
        
        .btn-login {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(124, 58, 237, 0.4);
        }
        
        .btn-login:disabled { opacity: 0.7; cursor: not-allowed; transform: none; }
        
        .message {
            padding: 0.875rem 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            display: none;
        }
        
        .message.error { background: #fef2f2; border: 1px solid #fecaca; color: #991b1b; }
        .message.success { background: #ecfdf5; border: 1px solid #a7f3d0; color: #065f46; }
        
        .demo-section {
            background: #f5f3ff;
            border: 1px solid #ddd6fe;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1.5rem;
        }
        
        .demo-section h4 { color: #5b21b6; margin-bottom: 0.75rem; font-size: 0.85rem; }
        
        .demo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; }
        
        .demo-account {
            padding: 0.5rem;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        
        .demo-account:hover { border-color: #7c3aed; }
        
        .demo-account .role { font-weight: 600; color: #1f2937; font-size: 0.8rem; }
        .demo-account .email { color: #6b7280; font-size: 0.7rem; }
        
        .back-link { text-align: center; margin-top: 1.5rem; }
        .back-link a { color: rgba(255,255,255,0.8); text-decoration: none; font-size: 0.9rem; }
        .back-link a:hover { color: white; text-decoration: underline; }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="icon">üéØ</div>
                <h1>Admin Portal</h1>
                <p>Summit Gear & Adventures</p>
            </div>
            
            <div class="login-body">
                <div class="message error" id="errorMsg"></div>
                <div class="message success" id="successMsg"></div>
                
                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label>üìß Email</label>
                        <input type="email" id="email" placeholder="admin@summitgear.co.uk" required>
                    </div>
                    
                    <div class="form-group">
                        <label>üîë Password</label>
                        <input type="password" id="password" placeholder="Enter password" required>
                    </div>
                    
                    <button type="submit" class="btn-login" id="loginBtn">üîì Login</button>
                </form>
                
                <div class="demo-section">
                    <h4>üß™ Admin Accounts (Password: admin123)</h4>
                    <div class="demo-grid">
                        <div class="demo-account" onclick="fillDemo('r.macgregor@summitgear.co.uk', 'admin123')">
                            <div class="role">üëë Store Manager</div>
                            <div class="email">Edinburgh</div>
                        </div>
                        <div class="demo-account" onclick="fillDemo('e.watson@summitgear.co.uk', 'admin123')">
                            <div class="role">üíº Business Admin</div>
                            <div class="email">Edinburgh</div>
                        </div>
                        <div class="demo-account" onclick="fillDemo('l.white@summitgear.co.uk', 'admin123')">
                            <div class="role">üì¶ Inventory Admin</div>
                            <div class="email">Edinburgh</div>
                        </div>
                        <div class="demo-account" onclick="fillDemo('d.henderson@summitgear.co.uk', 'admin123')">
                            <div class="role">üë• HR Admin</div>
                            <div class="email">Edinburgh</div>
                        </div>
                    </div>
                    <p style="font-size:0.75rem; color:#6b7280; margin-top:0.75rem; text-align:center;">
                        ‚ö†Ô∏è Staff accounts use password: <strong>staff123</strong> (Staff Portal only)
                    </p>
                </div>
            </div>
        </div>
        
        <div class="back-link">
            <a href="../index.html">‚Üê Back to Main Portal</a>
        </div>
    </div>
    
    <script>
        const API_BASE = '/summit-gear/api';
        
        // Clear login state on page load
        document.addEventListener('DOMContentLoaded', function() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('currentAdmin');
        });
        
        function fillDemo(email, password) {
            document.getElementById('email').value = email;
            document.getElementById('password').value = password || 'admin123';
        }
        
        async function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMsg');
            const successMsg = document.getElementById('successMsg');
            const loginBtn = document.getElementById('loginBtn');
            
            errorMsg.style.display = 'none';
            successMsg.style.display = 'none';
            
            loginBtn.disabled = true;
            loginBtn.textContent = '‚è≥ Logging in...';
            
            try {
                const response = await fetch(`${API_BASE}/employees.php?action=verify_admin&email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`);
                const result = await response.json();
                
                if (result.success && result.data) {
                    const admin = result.data;
                    
                    // Save login state
                    localStorage.setItem('adminLoggedIn', 'true');
                    localStorage.setItem('currentAdmin', JSON.stringify({
                        ...admin,
                        loginTime: new Date().toISOString()
                    }));
                    
                    successMsg.textContent = `‚úÖ Welcome, ${admin.name}!`;
                    successMsg.style.display = 'block';
                    
                    // Direct redirect based on position
                    const redirectMap = {
                        'Store Manager': 'store-manager.html',
                        'Business Admin': 'business-admin.html',
                        'Inventory Admin': 'inventory-admin.html',
                        'HR Admin': 'hr-admin.html'
                    };
                    
                    const targetPage = redirectMap[admin.position] || 'index.html';
                    
                    setTimeout(() => {
                        window.location.href = targetPage;
                    }, 500);
                } else {
                    errorMsg.textContent = '‚ùå Employee not found';
                    errorMsg.style.display = 'block';
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'üîì Login';
                }
            } catch (error) {
                errorMsg.textContent = '‚ùå Connection error';
                errorMsg.style.display = 'block';
                loginBtn.disabled = false;
                loginBtn.textContent = 'üîì Login';
            }
        }
    </script>
</body>
</html>
